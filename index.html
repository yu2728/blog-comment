<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Bluetooth Example</title>
    <meta http-equiv="Permissions-Policy" content="bluetooth=(self)">
</head>

<body>
    <h1>Bluetoothã¨æ¥ç¶šã—ã‚ˆã†ï¼ğŸ”µ</h1>
    <button id="connect">ãƒ‡ãƒã‚¤ã‚¹ã«æ¥ç¶š</button>
    <p id="status"></p>

    <script>
        document.getElementById('connect').addEventListener('click', async () => {
            async function findBluetoothDevice() {
                try {
                    const bluetooth = window.navigator.bluetooth;
                    if (!bluetooth) {
                        console.error("Bluetooth APIãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
                        return;
                    }

                    const device = await bluetooth.requestDevice({
                        acceptAllDevices: true
                    });

                    console.log("ãƒ‡ãƒã‚¤ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:", device);
                } catch (error) {
                    console.error("ãƒ‡ãƒã‚¤ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“:", error);
                }
            }

            findBluetoothDevice();
            
            // try {
            //     const device = await navigator.bluetooth.requestDevice({
            //         acceptAllDevices: true
            //     });
            //     document.getElementById('status').textContent = `ãƒ‡ãƒã‚¤ã‚¹å: ${device.name}`;

            //     const server = await device.gatt.connect();
            //     const service = await server.getPrimaryService('battery_service');
            //     const characteristic = await service.getCharacteristic('battery_level');

            //     const value = await characteristic.readValue();
            //     const batteryLevel = value.getUint8(0);

            //     document.getElementById('status').textContent += `\nãƒãƒƒãƒ†ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«: ${batteryLevel}%`;
            // } catch (error) {
            //     document.getElementById('status').textContent = `ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            // }
        });
    </script>
</body>

</html>